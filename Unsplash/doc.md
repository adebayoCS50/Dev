Here are my suggestions:

Use const instead of let or var for variables that do not need to be reassigned.

Add comments to explain what each section of the code is doing.

Separate the code into smaller, more focused functions to make it easier to read, test, and maintain.

Use destructuring to simplify the code and reduce duplication.

Use arrow functions to make the code more concise.

Use textContent instead of innerText to set the text of the error message element.

Use template literals instead of concatenation for building the image HTML.

Use a loading spinner while the images are being fetched to provide visual feedback to the user.

Here's the optimized code: see scriptV3